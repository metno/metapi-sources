# Sources access service for met-api

This implements a service for reading sources data, currently only
from a stinfosys database.

Document format is described in <https://phab.met.no/w/software/met_api/api_design/jsonld_schema/>.

------------

## Setup

This application only almost works out of the box. To make this work
for testing, you must create a file, conf/development.conf. This file
must at least contain the following keys:

  * db.stinfosys.url
  * db.stinfosys.username
  * db.stinfosys.password

See https://dokit.met.no/prosjekter/bora/kdvh-test for details on how
to set these options.

--------------

## Todo

### CGI params

- types - only SensorSystem currently allowed
- fields - not yet implemented
- validtime - ignored
- namespace - ignored

### JSON output

Header data not according to spec, but this is determined by the utils plugin

Error msgs not currently in JSON format

### Tests

Not implemented

### Mocking

Not implemented

### Logging

`logback.xml` autogenerated by Activator. Had to add `logger.xml` to make sql logging work.


select name, ST_GeomFromText('POINT(11.0383 59.9708)', 4326) as ME, ST_SetSRID(ST_MakePoint(lon, lat),4326) as PT from station where ST_DWITHIN(ST_GeomFromText('POINT(11.0383 59.9708)', 4326), ST_SetSRID(ST_MakePoint(lon, lat),4326), 0.1) order by st_distance(ST_GeomFromText('POINT(11.0383 59.9708)', 4326), ST_SetSRID(ST_MakePoint(lon, lat),4326)) LIMIT 1;